<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.question">

	<!-- 회원 질문 목록 조회 -->
	<resultMap type="HashMap" id="selectQstnAbout">
		<result property="questionAbout" column="QUESTION_ABOUT" jdbcType="CLOB" javaType="java.lang.String" />
	</resultMap>
	<select id="selectUserQstnAll" parameterType="int" resultType="HashMap"
		resultMap="selectQstnAbout">
		select * from userQstnView 
		where USER_NO=#{userNo} 
		order by QUESTION_NO desc
	</select>

	
	<!-- 질문 등록 -->
	<insert id="insertQstn" parameterType="questionVo">
		<selectKey keyProperty="questionNo" resultType="int" order="BEFORE">
			select QUESTION_SEQ.NEXTVAL from dual
		</selectKey>
		insert into question(QUESTION_NO,USER_NO,WORKKIND_NO,QUESTION_TITLE,QUESTION_ABOUT)
		values(#{questionNo},#{userNo},#{workkindNo},#{questionTitle},#{questionAbout})
	</insert>	
	
	<!-- 질문 목록 조회 -->
	<select id="selectQstn" parameterType="int" resultType="questionVo">
		select * from QUESTION where QUESTION_NO=#{questionNo}
	</select>
	
	<!-- 질문 수정 -->
	<update id="updateQstn" parameterType="questionVo">
		update QUESTION
		set WORKKIND_NO=#{workkindNo}, QUESTION_TITLE=#{questionTitle},
		  	QUESTION_ABOUT=#{questionAbout}, QUESTION_DATE=SYSDATE
		where QUESTION_NO=#{questionNo} and USER_NO=#{userNo}
	</update>
	
	<!-- 질문 조회 -->
	<select id="selectAllQstn" resultType="questionVo">
		select * from QUESTION order by QUESTION_NO desc
	</select>
	
	
	<!-- 회원 질문 개수 -->
	<select id="selectUserQstnCnt" parameterType="int" resultType="int">
		select count(*) from QUESTION where USER_NO=#{userNo} order by QUESTION_NO desc
	</select>
	
	
</mapper>









