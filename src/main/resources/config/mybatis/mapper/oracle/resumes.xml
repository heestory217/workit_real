<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.resumes">
	<resultMap type="ResumesAllVO" id="resumeList">
      <association property="resumesVo" column="resumeNo" javaType="ResumesVO">
         <id property="resumeNo" column="resume_No" jdbcType="BIGINT"/>
         <result property="userNo" column="user_No" jdbcType="BIGINT" />
         <result property="resumeTitle" column="resume_Title" jdbcType="VARCHAR" />
         <result property="resumeSelfintro" column="resume_Selfintro" jdbcType="VARCHAR" />
         <result property="resumeDate" column="resume_Date" jdbcType="TIMESTAMP" />
         <result property="resumeFilename" column="resume_Filename" jdbcType="VARCHAR" />
         <result property="resumeFilesize" column="resume_Filesize" jdbcType="BIGINT" />
         <result property="resumeFileoriginalname" column="resume_Fileoriginalname" jdbcType="VARCHAR" />
         <result property="resumeResumeopencheck" column="resume_Resumeopencheck" jdbcType="BIGINT" />
      </association>
      <collection property="languageList" column="resumeNo" javaType="ArrayList" ofType="LanguageListView" select="parameterType">
      	<id property="resumeNo" column="RESUME_NO" jdbcType="BIGINT"/>
      	<result property="languageNo" column="LANGUAGE_NO" jdbcType="BIGINT"/>
      	<result property="languageName" column="LANGUAGE_NAME" jdbcType="VARCHAR"/>
      </collection>
   	</resultMap>

	<select id="searchResumeByNo" parameterType="int" resultMap="resumeList">
		select * from resumes where resume_no=#{resumeNo}
	</select>
	
	<!-- 이력서 -->
	<insert id="insertResume" parameterType="resumesVO">
		<selectKey keyProperty="resumeNo" resultType="int" order="BEFORE">
			select RESUMES_SEQ.nextval from dual
		</selectKey>
		insert into RESUMES (RESUME_NO,USER_NO,RESUME_TITLE,RESUME_FINALEDUCATION,RESUME_SELFINTRO)
		values (#{resumeNo},#{userNo},#{resumeTitle},#{resumeFinaleducation},#{resumeSelfintro})
	</insert>
	
	<!-- 수상 -->
	<insert id="insertAward" parameterType="awardVo">
		<selectKey keyProperty="awardNo" resultType="int" order="BEFORE">
			select award_seq.nextval from dual
		</selectKey>
		insert into award(AWARD_NO, RESUME_NO,AWARD_ABOUT,AWARD_DATE)
		values(#{awardNo},#{resumeNo},#{awardAbout},#{awardDate})
	</insert>
	
	<!-- 경력 -->
	<insert id="insertCarrer" parameterType="carrerVO">
		<selectKey keyProperty="carrerNo" resultType="int" order="BEFORE">
			select CARRER_SEQ.nextval from dual
		</selectKey>
		insert into CARRER(CARRER_NO,CARRER_CORP,CARRER_STARTDATE,CARRER_ENDDATE,CARRER_WORK,RESUME_NO)
		values(#{carrerNo},#{carrerCorp},#{carrerStartdate},#{carrerEnddate},#{carrerWork},#{resumeNo})
	</insert>
	
	<!-- 자격증 -->
	<insert id="insertLicen" parameterType="licencseVO">
		<selectKey keyProperty="licencseNo" resultType="int" order="BEFORE">
			select LICENCSE_seq.nextval from dual
		</selectKey>
		insert into LICENCSE(LICENCSE_NO,RESUME_NO,LICENCSE_NAME,LICENCSE_ISSUEPLACE)
		values(#{licencseNo},#{resumeNo},#{licencseName},#{licencseIssueplace})
	</insert>
	
	<!-- 외국어 -->
	<insert id="insertForeignskill" parameterType="foreignlanguageskillVO">
		<selectKey keyProperty="foreignlanguageskillNo" resultType="int" order="BEFORE">
			select FOREIGNLANGUAGESKILL_SEQ.nextval from dual
		</selectKey>
		insert into FOREIGNLANGUAGESKILL(FOREIGNLANGUAGESKILL_NO,RESUME_NO,FOREIGNLANGUAGESKILL_LANG,FOREIGNLANGUAGESKILL_EXPERT)
		values (#{foreignlanguageskillNo},#{resumeNo},#{foreignlanguageskillLang},#{foreignlanguageskillExpert})
	</insert>
	
</mapper>









